<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qsxh.dao.DatingDao">

    <!--我的约会列表-->
    <select id="datingInform" resultType="com.qsxh.entity.Dating">
        select d.* , u.uname from tbldating d , tbluser u
        where (dtoid = #{userid} or dfromid = #{userid}) and dstate != '51' and d.dfromid = u.userid
        ORDER BY ddate desc , dtime desc
    </select>

    <!--查看约会详情-->
    <select id="datingDetails" resultType="com.qsxh.entity.Dating">
        select d.* , u.uname from tbldating d , tbluser u
        where dateid = #{dateid} and d.dfromid = u.userid
    </select>

    <!--回复约会-->
    <update id="replyDating">
        update tbldating set dreturn = #{dreturn} where dateid = #{dateid}
    </update>

    <!--接受约会-->
    <update id="acceptDating">
        update tbldating set dstate = '53' where dateid = #{dateid}
    </update>

    <!--拒绝约会-->
    <update id="rejectDating">
        update tbldating set dstate = '54' where dateid = #{dateid}
    </update>

    <!--和TA约会-->
    <insert id="dating" parameterType="com.qsxh.entity.Dating">
        insert into tbldating (ddate , dtime , dfromid , dtoid , dcontext , dstate , dpay , daddress)
        values (#{ddate} , #{dtime} , #{dfromid} , #{dtoid} , #{dcontext} , '51' , #{dpay} , #{daddress})
    </insert>

</mapper>
